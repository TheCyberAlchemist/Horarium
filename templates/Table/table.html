{% extends 'Table/base.html' %}
{% load static %}
{% block title %}
Table
{% endblock %}
{% block css %}	<!--  css links  -->


<link rel="stylesheet" type="text/css" href="{%static 'index.css'%}">
<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
<link href = "https://code.jquery.com/ui/1.10.4/themes/ui-lightness/jquery-ui.css">
<link rel="stylesheet" href="{%static 'table/button.css'%}">

{% endblock %}

{% block content %}

<p>
 <!-- Welcome,{{request.user}} -->
 <a href = "{% url 'logout' %}">logout </a>
 <!-- <a href = "{% url 'day_form' %}">day select</a> -->
</p>


<!--button table-->

<div class="main_container">
	<div class="butcontainer" draggable="true">
		<table id="table_but">
			<thead>
			</thead>
			<tbody class="tbooty">
				{% for event_butt in event_butts %} <!-- show all events button -->
					<tr><td>
						<div pk = "{{event_butt.id}}" class = "draggable" name = "{{event_butt.event_name}}" color = "{{event_butt.event_color}}" event_link = "{{event_butt.event_link}}"style = "background-color: {{event_butt.event_color}}">
							{{event_butt.event_name}}
						</div>
					</td></tr>
				{% endfor %}
			</tbody>
		</table>
		<!-- <button name="add" > <img src="plus1.png" class="addBut" alt="plus"> </button> -->
    <img src="{% static 'plus1.png' %}" class="addBut" id="open-form" alt="plus" onclick="openform()">
  </div>
  </div>

  <!-- POP UP FORM  -->

  <div class="form-container" id="form-container">
    <div class="form-container-div">
      <div id="close-form" onclick="closeform()">+</div>
      <form class="myform" id="myform-id">
      <input type="text" name="Eventname" placeholder="Event Name"><br>
      <input type="time" name="time" placeholder="Time">
      <div class="color-selector">
        <div style="background-color:red"></div>
        <div style="background-color:blue"></div>
        <div style="background-color:green"></div>
        <div style="background-color:pink"></div>
        <div style="background-color:cyan"></div>
        <div style="background-color:yellow"></div>
        <div style="background-color:orange"></div>
      </div>
      <input type="submit" name="save-button" value="Save">
      </form>
	  </div>
  </div>

  <!-- POP UP FORM ENDS -->

<!-- main timetable -->
<table style = "width:{{table_width}}px;" class="main_table">
	<thead>
		<th>
			Time
		</th>
		{% for day in days %}	<!--for all days in database-->
			<th>
				{{day}}
			</th>
		{% endfor %}
	</thead>
	<tbody class="table_time">
		{% for period in periods %} <!--for all time periods in database-->
			<tr>
				<th pk = "{{period.id}}">
					<p>
						{{period}}
					</p>
				</th>
				{% for day in days %}
					<td class = "droppable" name = "NONE" day = "{{day}}" period = "{{period.id}}">
						<div class = "td_div">
						</div>
					</td>
				{% endfor %}
			</tr>
		{% endfor %}
	</tbody>
	{% comment %} <tfoot>
    <tr>
      <td colspan = "{{day_len}}"  ><img src="{% static 'plus1.png' %}" class="addRow" alt="plus"></td>
    </tr>

  </tfoot> {% endcomment %}
</table>
{% for event in events %}	<!--iterating over all events in database -->
	<script>
		td = document.getElementsByClassName("droppable");
		for (i = 0 ; i < td.length ; i++){
			day = td[i].getAttribute("day");
			period_id = td[i].getAttribute("period");
			// if day of event and day of cell is same
			// and period id of event object and period id of cell is same
			if(day == "{{event.day}}" && period_id == {{event.time_obj.id}}){
				console.log(td[i]);
			}
		}
	</script>
{% endfor %}
<br>
<center><button class = "save">Save</button></center>

{% endblock %}

{% block scripts %}

<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script>
<script type="text/javascript" src="{%static 'index.js'%}"></script>
<script type="text/javascript" src="{%static 'tabletojson/tabletojson.js'%}"></script>
<script type="text/javascript" src="{%static 'tabletojson/tabletojson-row.js'%}"></script>
<script type="text/javascript" src="{%static 'tabletojson/tabletojson-cell.js'%}"></script>
{% comment %} <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script> {% endcomment %}
{% comment %} <script src = "https://code.jquery.com/ui/1.10.4/jquery-ui.js"></script> {% endcomment %}
{% comment %} <script src="{% static 'table/button.js'%}"></script> {% endcomment %}

{% endblock %}
